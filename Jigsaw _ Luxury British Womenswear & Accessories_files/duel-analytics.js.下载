!function n(o,a,i){function u(t,e){if(!a[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=a[t]={exports:{}},o[t][0].call(r.exports,function(e){return u(o[t][1][e]||e)},r,r.exports,n,o,a,i)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<i.length;e++)u(i[e]);return u}({1:[function(e,t,r){"use strict";var a=e("./src/commands"),i=e("./src/parameters"),n=e("./src/helpers"),u=(e=e("./module"))&&e.__esModule?e:{default:e};function o(){u.default.init(function(){var r=u.default.debug,n=u.default.logError,o={};Object.defineProperties(u.default.config,{storageMinutesToLive:{enumerable:!0,get:function(){return o.storageMinutesToLive||43200},set:function(e){var t="config.storageMinutesToLive";"number"!=typeof e||e<1?n("".concat(t," must be a number >= 1")):(r("Set ".concat(t," to ").concat(e)),o.storageMinutesToLive=e)}},affiliateAttributionCap:{enumerable:!0,get:function(){return o.affiliateAttributionCap||Number.MAX_SAFE_INTEGER},set:function(e){var t="config.affiliateAttributionCap";Number.isInteger(e)&&1<=e?(r("Set ".concat(t," to ").concat(e)),o.affiliateAttributionCap=e):n("".concat(t," must be a positive integer"))}},storageTTL:{enumerable:!0,get:function(){return Math.round(60*this.storageMinutesToLive*1e3)}}}),u.default.exec=a.exec,u.default.parameters=i.parameters,i.parameters.save()})}Object.assign?o():(0,n.loadScript)("".concat(u.default.env.serviceURL,"/polyfill-es6.min.js"),o)},{"./module":2,"./src/commands":3,"./src/helpers":4,"./src/parameters":5}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.namespace=r.logError=r.env=r.default=r.debug=r.config=void 0;var n=((u=e("../bootstrap"))&&u.__esModule?u:{default:u}).default.module("analytics"),o=n.namespace,a=n.debug,i=n.logError,e=n.env,u=n.config;r.config=u,r.env=e,r.logError=i,r.debug=a,r.namespace=o,r.default=n},{"../bootstrap":6}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exec=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==p(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((a=o?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(e("../module")),u=e("./parameters"),c=e("./helpers");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(l=function(e){return e?r:t})(e)}function s(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.exec=function(e){var t=a[e];if(t){for(var r=arguments.length,n=new Array(1<r?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)}(0,i.logError)("No command exists with the name '".concat(e,"'"))};var a={};a.attribution=function(a){if(a){(0,i.debug)("Sending attribution");var e=window.URLSearchParams;if("object"!==p(a)||Array.isArray(a)){if("string"!=typeof a)return void(0,i.logError)('Attribution parameters must be passed as object {...} or URL parameter string "a=1&b=2..."')}else{var t=Object.keys(a).reduce(function(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=d(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw o}}}}(Array.isArray(a[t])?a[t]:[a[t]]);try{for(n.s();!(r=n.n()).done;){var o=r.value;e.push([t,o])}}catch(e){n.e(e)}finally{n.f()}return e},[]);a=e?String(new e(t)):t.map(function(e){var t=f(e,2),e=t[0],t=t[1];return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t))}).sort().join("&")}var o=u.parameters.retrieve();if(o.size)for(var r in o)!function(t){var e,r=o[t].value,n=u.parameters.find(function(e){return e.name===t});n&&(e=n.sendAs||e,a+="&".concat(e,"=").concat(encodeURIComponent(r))),(r=o[t]).usage||(r.usage=0),o[t].usage++,o.changesPending=!0}(r);e&&(a=new e(s(new e(a).entries()).sort((0,c.objectEntriesSorter)(["slug","order","promo","total","currency"]))).toString());var n="".concat(i.env.apiURL,"/attribution?").concat(a),t=function(){i.default.eventLog.push({command:"attribution",status:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).status,parameters:a}),o.changesPending&&o.save(),(0,i.debug)("Attributed ".concat(a))};window.fetch?fetch(n,{headers:{Accept:"application/vnd.duel+json"}}).then(t).catch(i.logError):((e=new XMLHttpRequest).open("GET",n),e.send(null),t())}else(0,i.logError)("Attribution requires parameters")}},{"../module":2,"./helpers":4,"./parameters":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.supports=r.objectEntriesSorter=r.loadScript=r.cookie=void 0;var a=e("../module");function u(e,t){return l(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||i(e,t)||o()}function n(e){return l(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e){if(Array.isArray(e))return e}function s(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function f(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?s(Object(o),!0).forEach(function(e){var t,r;t=n,e=o[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}r.supports={_results:{},get localStorage(){var e,t="localStorage";if("boolean"==typeof this._results[t])return this._results[t];try{if(null===(e=window.localStorage)||void 0===e||!e.getItem)return this._results[t]=!1;var r="".concat(a.namespace,"-storageTest");window.localStorage.setItem(r,"{}");var n=window.localStorage.getItem(r);return window.localStorage.removeItem(r),this._results[t]="{}"===n}catch(e){(0,a.logError)(e)}return this._results[t]=!1}},r.cookie={save:function(e){var t="https:"===location.protocol,r=f({path:"/",expires:new Date(Date.now()+a.config.storageTTL).toUTCString(),secure:t},t&&{sameSite:"None"});e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);var n,o="";for(n in r)r[n]&&(o+="; "+n,!0!==r[n]&&(o+="="+r[n].split(";")[0]));return document.cookie=a.namespace+"="+e+o},retrieve:function(){var e=null===(e=((null===(e=document.cookie)||void 0===e?void 0:e.split(/\s*;\s*/))||[]).map(function(e){e=n(e.split("="));return[e[0],e.slice(1).join("=")]}).find(function(e){return u(e,1)[0]===a.namespace}))||void 0===e?void 0:e[1];return(e=e&&e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent))||null}};r.loadScript=function(e,t){var r=document.createElement("script");r.onload=t,r.src=e;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)};r.objectEntriesSorter=function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return function(e,t){var r=u(e,1)[0],n=u(t,1)[0],o=i.indexOf(r),a=-1===o,e=i.indexOf(n),t=-1===e;return a||t?a&&!t?1:!a&&t?-1:r===n?0:n<r?1:-1:o===e?0:e<o?1:-1}}},{"../module":2}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parameters=void 0;var u=e("../module"),o=e("./helpers");function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s=[{name:"duel_a",sendAs:"affiliate"},{name:"duel_c",sendAs:"ugc"}];(r.parameters=s).save=function(){var e=a();if(e){(0,u.debug)("Incoming parameter(s): ".concat(Object.keys(e).join(", ")));var t,r=s.retrieve();for(t in e)r[t]={value:e[t],time:Date.now()};r.save()}else(0,u.debug)("No incoming parameters")},s.retrieve=function(){var e,t;o.supports.localStorage&&(e=localStorage.getItem(u.namespace),t="localStorage"),e||(e=s.cookie.retrieve(),t="cookie"),e||(e=s.saved,t="memory");var r="No saved parameters";e||(0,u.debug)(r);var n={};if(e)try{n=JSON.parse(e),Object.keys(n).length?(0,u.debug)("Saved parameters retrieved from ".concat(t)):(0,u.debug)(r)}catch(e){(0,u.logError)(e)}return Object.defineProperties(n,{save:{value:function(){return s.saved=JSON.stringify(this),o.supports.localStorage&&localStorage.setItem(u.namespace,s.saved),s.cookie.save(s.saved),(this.changesPending=!1,u.debug)("Save parameters"),this}},prune:{value:function(){for(var e=Date.now()-u.config.storageTTL,t=0,r=Object.keys(this);t<r.length;t++){var n=r[t],o=this[n],a=o.time,i=o.usage,o=void 0;a<e?o="expired":"duel_a"===n&&(void 0===i?0:i)>=u.config.affiliateAttributionCap&&(o="capped"),o&&((0,u.debug)("Prune ".concat(o," parameter '").concat(n,"'")),delete this[n],this.changesPending=!0)}return this}},changesPending:{value:!1,writable:!0},size:{get:function(){return Object.keys(this).length}}}),n.prune()};var a=function(){var t=s.map(function(e){return e.name}),e={};if(window.URLSearchParams){var r,n=new URL(location.href),o=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw o}}}}(t);try{for(o.s();!(r=o.n()).done;){var a,i=r.value;n.searchParams.has(i)&&((a=n.searchParams.get(i))&&(e[i]=a),n.searchParams.delete(i))}}catch(e){o.e(e)}finally{o.f()}history.replaceState&&Object.keys(e).length&&history.replaceState(null,document.title,String(n))}else location.search.slice(1).replace(/&amp;/g,"&").split("&").map(function(e){return e.split("=").map(function(e){return decodeURIComponent(e)})}).filter(function(e){e=c(e,1)[0];return-1!==t.indexOf(e)}).reduce(function(e,t){var r=c(t,2),t=r[0],r=r[1];return e[t]=r,e},e);return Object.keys(e).length?e:null};s.cookie=o.cookie},{"../module":2,"./helpers":4}],6:[function(e,t,r){"use strict";function d(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a=[],i=!0,u=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{i||null==r.return||r.return()}finally{if(u)throw o}}return a}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,y=window.duel||{};y.modules||(a=["apiURL","serviceURL","debug","q"].reduce(function(e,t){return y[t]&&(e[t]=y[t]),e},{}),y=window.duel=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=p(t[0].split(":"),2),o=n[0],n=n[1];y.modules[o]?(o=y.modules[o]).exec.apply(o,[n].concat(d(t.slice(1)))):y.q.push(t)},Object.assign(y,{q:[]},a,{env:{},modules:{}}),o=function(e){if(!e)return!1;var t=document.createElement("a");t.href=e;t=t.hostname;return/\.duel\.(me|tech)$|^localhost$|^192(\.\d{1,3}){3}$|^duel-local-([a-z]+)\.([a-z]+)$/.test(t)},Object.defineProperties(y.env,{serviceURL:{get:function(){return o(y.serviceURL)?y.serviceURL:"https://vision.duel.me"}},apiURL:{get:function(){return o(y.apiURL)?y.apiURL:"https://api.duel.me"}}}),y.module=function(e){if(y.modules[e])return y.modules[e].debug("Module is already defined"),y.modules[e];var t="duel-".concat(e),o="".concat(t,":"),f=y.modules[e]={name:e,namespace:t,logError:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).error.apply(e,[o].concat(r))},debug:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return y.debug&&(e=console).debug.apply(e,[o].concat(r))},env:y.env,config:{},eventLog:[],init:function(e){if(!f.initialized){f.initialized=!0,null!=e&&e(f);var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=m(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,t=function(){};return{s:t,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw o}}}}(y.q);try{for(r.s();!(t=r.n()).done;){var n,o,a,i,u=t.value,c=p(u[0].split(":"),2),l=c[0],s=c[1];l===f.name&&(n=d(u).slice(1),"config"===s?(a=(o=p(n,2))[0],i=o[1],f.config[a]=i):f.exec.apply(f,[s].concat(d(n))))}}catch(e){r.e(e)}finally{r.f()}}}};return f});var a=y;r.default=a},{}]},{},[1]);