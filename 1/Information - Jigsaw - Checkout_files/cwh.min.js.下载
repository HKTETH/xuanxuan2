"use strict";async function r(e){/in/.test(document.readyState)?setTimeout("r("+e+")",9):e()}r((async function(){let e,t,r,n,a,o,s,i,d,c="https://production.api.harperconcierge.com",l=[],p=[],m=[],u=[],h=[],g=[],y=!0,v=!0,f=!0,_=async function(){document.getElementById("harper-concierge-slider").classList.toggle("harper-content"),document.getElementById("harper-concierge-slider").classList.toggle("closed"),document.getElementById("harper").classList.toggle("closed"),document.getElementById("close-button").classList.toggle("hidden"),document.getElementById("london-message").classList.toggle("harper-cwh-hidden"),document.getElementById("harper").classList.toggle("border-popup"),!1===n.enable_icon_question&&document.getElementById("icon__question").classList.add("hidden")},E=function(){let e=[];Array.from(document.getElementsByClassName("modal-mask")).forEach((function(t){e.push(t)})),Array.from(document.getElementsByClassName("popup-message")).forEach((function(t){e.push(t)})),Array.from(e).forEach((function(e){e.classList.toggle("active")}))},b=function(){let e=[];Array.from(document.getElementsByClassName("modal-mask")).forEach((function(t){e.push(t)})),Array.from(document.getElementsByClassName("popup-message")).forEach((function(t){e.push(t)})),Array.from(e).forEach((function(e){e.classList.remove("active")}))},B=async function(){let e=await fetch("/cart.js");return await e.json()},I=async function(){if(e=await B(),e.postcode=document.querySelector('input[name="postcode"]').value,r=!1,document.getElementById("harper-error").innerHTML="",""!==e.postcode||r){let t=[];for(let r=0;r<e.items.length;r++)t.push({id:e.items[r].id.toString(),product_id:e.items[r].product_id,price:e.items[r].final_price,name:e.items[r].title,sku:e.items[r].sku,discount:e.items[r].discounted_price.toString(),order_id:"",size:e.items[r].variant_title||"",colour:e.items[r].colour||"",qty:e.items[r].quantity,images:[{url:e.items[r].image,size:""}],additional_attributes:{name:"",value:"",shopify_details:e.items[r]}});const a={postcode:e.postcode,partner:n.partner_reference,items:t},o=c+"/api/check-postcode/",s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MmFjOGU2MTA0YmViOTQ2NWEyZDU1MTEiLCJlbWFpbCI6ImRhdGFzdXBwb3J0QGhhcnBlcmNvbmNpZXJnZS5jb20iLCJpYXQiOjE2NTU0NzU5NTMsImV4cCI6MTY1Nzg5NTE1M30.ujMNnjg0vFdPPn-uYzAGXyUZhFAygU_D-i55YBJjTeY"},body:JSON.stringify(a)};let l;try{const e=await fetch(o,s);l=await e.json()}catch(e){return e}if(l.isValid)document.getElementById("harper_continue_button").classList.add("hidden"),await L();else if(l.error.data&&!1===l.error.data.success)if(l.error.data.items_block&&l.error.data.items_block.length>0){f=!1,i=n.popup2_step_1_message,d=n.popup2_step_2_message,p=l.error.data.items_pre_order,m=l.error.data.items_block,u=l.error.data.items_available,g=l.error.data.items_partially_blocked,document.getElementById("harper-error-message1").innerHTML=i,"shrimps"===n.partner_reference&&(document.getElementById("harper-preorder-modal").classList.add("font-configuration"),document.getElementById("harper-preorder-modal").classList.remove("modal-container"));for(let e=0;e<m.length;e++)document.getElementById("harper-blocked-item").innerHTML+=m[e].name+"<br />";if(g.length>0)for(let e=0;e<g.length;e++)document.getElementById("harper-blocked-item").innerHTML+=g[e].name+"<br />";if(p.length>0)for(let e=0;e<p.length;e++)document.getElementById("harper-blocked-item").innerHTML+=p[e].name+"<br />";h=g.length>0&&u.length>0?u.concat(g):u,!1===l.error.data.can_proceed||!0===l.error.data.can_proceed&&!0===n.completely_block_sale_item?(document.getElementById("harper-preorder-button").innerHTML="CHECKOUT",document.getElementById("harper-order-brand").classList.add("place-order-hide"),document.getElementById("harper-order-brand").classList.remove("place-order"),document.getElementById("harper-error-message2").classList.add("harper-message2-hide"),document.getElementById("harper-error-message2").classList.remove("harper-message2"),v=!1):(document.getElementById("harper-preorder-button").innerHTML="PROCEED ANYWAY",document.getElementById("harper-order-brand").innerHTML="Place full order with "+n.partner_name,document.getElementById("harper-order-brand").classList.add("place-order"),document.getElementById("harper-order-brand").classList.remove("place-order-hide"),document.getElementById("harper-error-message2").innerHTML=d,document.getElementById("harper-error-message2").classList.remove("harper-message2-hide"),document.getElementById("harper-error-message2").classList.add("harper-message2"),v=!0),E()}else{f=!1,i=n.popup_step_1_message,d=n.popup_step_2_message,p=l.error.data.items_pre_order,m=l.error.data.items_block,u=l.error.data.items_available,g=l.error.data.items_partially_blocked,document.getElementById("harper-error-message1").innerHTML=i,"shrimps"===n.partner_reference&&(document.getElementById("harper-preorder-modal").classList.add("font-configuration"),document.getElementById("harper-preorder-modal").classList.remove("modal-container"));for(let e=0;e<p.length;e++)document.getElementById("harper-preorder-item").innerHTML+=p[e].name+"<br />";if(p.length>0&&g.length>0&&0==u.length||g.length>0&&0==u.length&&0==p.length)for(let e=0;e<g.length;e++)document.getElementById("harper-blocked-item").innerHTML+=g[e].name+"<br />";h=g.length>0&&u.length>0?u.concat(g):u,!1===l.error.data.can_proceed?(document.getElementById("harper-preorder-button").innerHTML="CHECKOUT",document.getElementById("harper-order-brand").classList.add("place-order-hide"),document.getElementById("harper-order-brand").classList.remove("place-order"),document.getElementById("harper-error-message2").classList.add("harper-message2-hide"),document.getElementById("harper-error-message2").classList.remove("harper-message2"),v=!1):(document.getElementById("harper-preorder-button").innerHTML="PROCEED ANYWAY",document.getElementById("harper-order-brand").innerHTML="Place full order with "+n.partner_name,document.getElementById("harper-order-brand").classList.add("place-order"),document.getElementById("harper-order-brand").classList.remove("place-order-hide"),document.getElementById("harper-error-message2").innerHTML=d,document.getElementById("harper-error-message2").classList.remove("harper-message2-hide"),document.getElementById("harper-error-message2").classList.add("harper-message2"),v=!0),E()}else l.error&&(document.getElementById("harper-success").classList.add("hidden"),document.getElementById("harper-error").classList.remove("hidden"),document.getElementById("harper-error").innerHTML=l.error,document.getElementById("harper-success").innerHTML="",r=!0);document.body.classList.add("harper-inserted")}else document.getElementById("harper-error").innerHTML="Your postcode cannot be empty",r=!0},L=async function(){if(t={return_url:window.location.href,cart_id:e.token,partner_reference:n.partner_reference,email:"",appointment:{},customer:{},items:[]},l=[],!0===f)for(let t=0;t<e.items.length;t++)l.push({id:e.items[t].id.toString(),product_id:e.items[t].product_id,price:e.items[t].final_price,name:e.items[t].title,sku:e.items[t].sku,discount:e.items[t].discounted_price.toString(),order_id:"",size:e.items[t].variant_title||"",colour:e.items[t].colour||"",qty:e.items[t].quantity,images:[{url:e.items[t].image,size:""}],additional_attributes:{name:"",value:"",shopify_details:e.items[t]}});else for(let e=0;e<h.length;e++)l.push({id:h[e].id.toString(),product_id:h[e].product_id,price:h[e].price,name:h[e].name,sku:h[e].sku,discount:h[e].discount,order_id:"",size:h[e].size,colour:h[e].colour,qty:h[e].qty,images:[{url:h[e].images[0].url,size:""}],additional_attributes:{name:"",value:"",shopify_details:h[e].additional_attributes.shopify_details}});t.items=l,t.postcode=document.querySelector('input[name="postcode"]').value;const r=c+"/api/carts/create",a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MmFjOGU2MTA0YmViOTQ2NWEyZDU1MTEiLCJlbWFpbCI6ImRhdGFzdXBwb3J0QGhhcnBlcmNvbmNpZXJnZS5jb20iLCJpYXQiOjE2NTU0NzU5NTMsImV4cCI6MTY1Nzg5NTE1M30.ujMNnjg0vFdPPn-uYzAGXyUZhFAygU_D-i55YBJjTeY"},body:JSON.stringify(t)};try{const e=await fetch(r,a),t=await e.json(),o=s+t.data.cart._id+"&utm_source="+n.partner_reference+"&utm_medium=website";window.location.href=o,await async function(){document.getElementById("harper-confirm-popup").style.display="none"}()}catch(e){return e}};await async function(){let e=document.getElementById("harper-identification");if(e){a=e.className;let t=await fetch("https://s3-eu-west-1.amazonaws.com/harper.assets/"+a+".json");n=await t.json()}}(),await B(),await async function(){n.env?(c=n.env.api_url,s=n.env.checkout_url):(c="https://production.api.harperconcierge.com",s="https://checkout.harperconcierge.com/?c=")}();const k='<div>\n    <h3 id="harper_try_at_home_button" class="try-at-home-btn" class="header">\n'+n.try_at_home_btn_text+'</h3>\n</div>\n<div id="london-message" class="harper-bottom-message">\n    <p>'+n.message_under_try_at_home_btn+'</p>\n</div>\n\n<div id="harper-checkout-wrapper" class="harper-wrapper">\n    <div class="vl-popup closed" id="harper">\n        <div id="close-button" class="vl-close-button hidden">\n            <svg style="height: 15px; width: 15px;" class="Icon Icon--close" role="presentation" viewBox="0 0 16 14">\n                <path d="M15 0L1 14m14 0L1 0" stroke="currentColor" fill="none" fill-rule="evenodd"></path>\n            </svg>\n        </div>\n        <div id="harper-concierge-slider" class="closed clearfix">\n            <div class="vl-popup-title">\n                <h1 class="popup-title">'+n.postcode_checker_title+"</h1>\n"+n.cwh_content+'            </div>\n            <div class="vl-send-basket-form">\n                <div id="harper-error" class="vl-error-message"></div>\n                <div id="harper-success" class="vl-success-message hidden"></div>\n                <form name="harper-send-to-parent-form" id="harper-send-to-parent-form" class="vl-form-container">\n                    <input id="harper-cart-data" type="hidden" name="harper-cartdata" value=""/>\n                    <input type="hidden" name="harper-retailer" value="1011">\n                    <div class="vl-input-holder">\n                        <input\n                                type="text"\n                                class="form-control"\n                                id="postcode"\n                                name="postcode"\n                                placeholder="'+n.post_code_placeholder+'"\n                                value=""/>\n                    </div>\n                    <div class="vl-input-holder">\n                        <button id="harper_continue_button" type="button">'+n.postcode_checker_btn_text+'</button>\n                    </div>\n                </form>\n            </div>\n        </div>\n                <div id="icon__question" class="message_postcode">\n <p>'+n.message_under_postcode_checker+'                <svg class="open-harper-modal" width="13" height="13" viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n                  <circle cx="9" cy="9" r="8.5" stroke="#1D1D1B"></circle>\n                  <path d="M5.625 6.36986H7.34576C7.40434 5.47653 8.0121 4.90538 8.95669 4.90538C9.87931 4.90538 10.4944 5.45456 10.4944 6.21609C10.4944 6.941 10.1868 7.32909 9.27887 7.87827C8.26838 8.47138 7.84368 9.1304 7.90958 10.2288L7.91691 10.7267H9.6157V10.3093C9.6157 9.58438 9.88663 9.21094 10.8459 8.64712C11.8417 8.05401 12.3982 7.27051 12.3982 6.15018C12.3982 4.53194 11.0582 3.375 9.05188 3.375C6.87713 3.375 5.68358 4.63445 5.625 6.36986ZM8.84685 14.2195C9.59373 14.2195 10.0624 13.7581 10.0624 13.0552C10.0624 12.3449 9.59373 11.8836 8.84685 11.8836C8.11461 11.8836 7.63133 12.3449 7.63133 13.0552C7.63133 13.7581 8.11461 14.2195 8.84685 14.2195Z" fill="#1D1D1B"></path>\n               </svg>\n </p>\n             </div>\n    </div>\n</div>',w='<div id="checkout-with-harper-modal" class="popup-overlay harper-popup-wrapper n-animate">\n    <div class="popup-content harper-popup-inner">\n\n\n        <div class="popup-content n-animate">\n\n\n\n\n            <button class="close-harper-modal"></button>\n            <div class="top-section">\n                <div class="top-section-left">\n\n\n                    <h2>'+n.popup_title+'</h2>\n\n                    <p class="harper-white">'+n.popup_content+' </b></p>\n\n\n                    <div class="mob-only">\n                        <p class="bold">'+n.popup_bottom_message+'</p>\n\n                        <a href="#harp-pop-sect-2" class="scroll-link">Scroll</a>\n                    </div>\n\n                </div>\n\n\n                <div class="top-section-right desk-only">\n                </div>\n\n            </div>\n\n\n\n\n\n            <div class="bottom-section" id="harp-pop-sect-2">\n\n                <button class="close-harper-modal mob-only"></button>\n\n                <h3 class="mob-only">How it works</h3>\n\n                <div class="num-section">\n                    <div class="num-row">\n                        <div class="num-num">1.</div>\n\n                        <div class="num-copy">\n                            <h5>'+n.popup_step_1_title+"</h5>\n                            "+n.popup_step_1_content+'                        </div>\n                    </div>\n\n                    <div class="num-row">\n                        <div class="num-num">2.</div>\n\n\n                        <div class="num-copy">\n                            <h5>'+n.popup_step_2_title+"</h5>\n                            "+n.popup_step_2_content+'                        </div>\n                    </div>\n\n                    <div class="num-row last">\n                        <div class="num-num">3.</div>\n\n                        <div class="num-copy"><h5>'+n.popup_step_3_title+"</h5>\n                            "+n.popup_step_3_content+'                        </div>\n                    </div>\n\n                </div>\n\n                <p class="bold desk-only">'+n.popup_bottom_message+'</p>\n\n                <div class="faq-link"><a href="'+n.faq_link+'" target="_blank">Visit our FAQ page</a></div>\n\n            </div>\n        </div>\n    </div>\n</div>';o=document.createElement("link"),o.href="https://s3-eu-west-1.amazonaws.com/harper.assets/harper-styles.css",o.rel="stylesheet",document.head.appendChild(o);let T=function(){let e=[],t=document.getElementById("harper-modal-override");if(t){t.style.display="block",t.style.visibility="visible",t.style.opacity=1;let e=t.getElementsByTagName("div")[0];return e&&(e.style.display="block",e.style.visibility="visible",e.style.opacity=1),!0}Array.from(document.getElementsByClassName("popup-content")).forEach((function(t){e.push(t)})),Array.from(document.getElementsByClassName("popup-overlay")).forEach((function(t){e.push(t)})),Array.from(e).forEach((function(e){e.classList.toggle("active")}))},C=function(){let e=[],t=document.getElementById("harper-modal-override");if(t){t.style.display="none",t.style.visibility="hidden",t.style.opacity=0;let e=t.getElementsByTagName("div")[0];return e&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity=0),!0}Array.from(document.getElementsByClassName("popup-content")).forEach((function(t){e.push(t)})),Array.from(document.getElementsByClassName("popup-overlay")).forEach((function(t){e.push(t)})),Array.from(e).forEach((function(e){e.classList.remove("active")}))};document.addEventListener("click",(function(e){if(e.target&&"harper_try_at_home_button"===e.target.id)_();else if(e.target&&"harper_continue_button"===e.target.id)I();else if(e.target&&"harper-preorder-button"===e.target.id)document.getElementById("harper_continue_button").classList.add("hidden"),async function(){if(await b(),!1===v){const e=window.location.origin+"/checkout";window.location.href=e}else await L()}();else if(e.target&&"harper-order-brand"===e.target.id){const e=window.location.origin+"/checkout";window.location.href=e}else e.target&&"harper-modal-mask"===e.target.id&&(document.getElementById("harper-preorder-item").innerHTML="",document.getElementById("harper-blocked-item").innerHTML="",b())})),document.addEventListener("keypress",(function(e){e.target&&"postcode"===e.target.id&&13===e.keyCode&&(e.preventDefault(),I())}));let M=function(){let e=[];Array.from(document.getElementsByClassName("open-harper-modal")).forEach((function(t){e.push(t)})),Array.from(e).forEach((function(e){e.addEventListener("click",T)})),Array.from(document.getElementsByClassName("Icon--close")).forEach((function(e){e.addEventListener("click",_)}));let t=[];Array.from(document.getElementsByClassName("close-harper-modal")).forEach((function(e){t.push(e)})),Array.from(document.getElementsByClassName("harper-popup-wrapper")).forEach((function(e){t.push(e)})),Array.from(t).forEach((function(e){e.addEventListener("click",C)}))},N=function(){let e=document.getElementById("checkout-harper"),t=document.getElementById("mole");e&&!t&&function(){let e=document.getElementById("checkout-harper");if(e){if(!0===y){let e=document.createElement("div"),t=document.createElement("div");e.innerHTML=w,t.innerHTML='<div id="harper-concierge-preorder" class="popup-message" >\n<div id="harper-modal-mask" class="modal-mask">\n<div id="harper-preorder-modal" class="modal-container">\n<div class="preorder-heading">\n<h3 class= "preOrder_title">TRY AT HOME</h3>\n</div>\n<div id="harper-preorder-item" class="harper-item-list"></div>\n<div id="harper-blocked-item" class="harper-item-list"></div>\n<div id= "harper-error-message1" class="harper-message1"></div>\n<div id= "harper-error-message2" class="harper-message2"></div>\n<div>\n<h3 id="harper-preorder-button" class="proceed-btn"></h3>\n</div>\n<div id= "harper-order-brand" class="place-order"></div>\n</div>\n</div>',document.body.appendChild(e),document.body.appendChild(t)}let t='<div id="mole"></div>';e.insertAdjacentHTML("afterend",k),e.insertAdjacentHTML("afterend",t),M(),b(),document.body.classList.add("harper-inserted"),y=!1}}(),setTimeout(N,10)};N()}));